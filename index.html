<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©</title>
  <style>
    body { font-family: Arial; background:#f5f5f5; padding:20px; direction: rtl }
    input, select, button { width:100%; padding:10px; margin:8px 0 }
    .box { background:#fff; padding:20px; border-radius:8px }
    pre { white-space: pre-wrap }
  </style>
</head>
<body>

<div class="box">
  <h2>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø³Ø¹Ø±Ø§Øª + Ø¬Ø¯ÙˆÙ„ ØºØ°Ø§Ø¦ÙŠ ğŸ¤–</h2>

  <input id="age" type="number" placeholder="Ø§Ù„Ø¹Ù…Ø±">
  <input id="height" type="number" placeholder="Ø§Ù„Ø·ÙˆÙ„ (Ø³Ù…)">
  <input id="weight" type="number" placeholder="Ø§Ù„ÙˆØ²Ù† (ÙƒØº)">

  <select id="gender">
    <option value="male">Ø°ÙƒØ±</option>
    <option value="female">Ø£Ù†Ø«Ù‰</option>
  </select>

  <select id="activity">
    <option value="1.2">Ù†Ø´Ø§Ø· Ù‚Ù„ÙŠÙ„</option>
    <option value="1.55">Ù†Ø´Ø§Ø· Ù…ØªÙˆØ³Ø·</option>
    <option value="1.75">Ù†Ø´Ø§Ø· Ø¹Ø§Ù„ÙŠ</option>
  </select>

  <select id="goal">
    <option value="-500">ØªÙ†Ø­ÙŠÙ</option>
    <option value="0">ØªØ«Ø¨ÙŠØª</option>
    <option value="400">Ø²ÙŠØ§Ø¯Ø© ÙˆØ²Ù†</option>
  </select>

  <button onclick="calculate()">Ø§Ø­Ø³Ø¨</button>

  <h3 id="caloriesEl"></h3>
  <pre id="result"></pre>
</div>

<script>
async function calculate() {
  const ageVal = Number(document.getElementById("age").value)
  const heightVal = Number(document.getElementById("height").value)
  const weightVal = Number(document.getElementById("weight").value)
  const genderVal = document.getElementById("gender").value
  const activityVal = Number(document.getElementById("activity").value)
  const goalVal = Number(document.getElementById("goal").value)

  let bmr = genderVal === "male"
    ? 10 * weightVal + 6.25 * heightVal - 5 * ageVal + 5
    : 10 * weightVal + 6.25 * heightVal - 5 * ageVal - 161

  let calories = Math.round(bmr * activityVal + goalVal)

  document.getElementById("caloriesEl").innerText =
    "Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©: " + calories + " kcal"

  // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ API (Gemini / OpenAI / Backend)
  const res = await fetch("/.netlify/functions/gemini", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ calories })
  })

  const data = await res.json()
  document.getElementById("result").innerText = data.plan
}
</script>

</body>
</html>
